var spweb=spweb||{};spweb.account=spweb.account||{},spweb.account.submenu=function(e){"use strict";var n={};return n.init=function(){var n=e("footer, .container-submenu, .submenu-backdrop, .content-wrapper");e(".btn-group-inverse").on("show.bs.dropdown",function(){n.addClass("submenu-open")}),e(".btn-group-inverse").on("hide.bs.dropdown",function(){n.removeClass("submenu-open")})},n}(jQuery);var spweb=spweb||{};spweb.account=spweb.account||{},spweb.account.form=function(e,n){var t={},s=null;return t.init=function(t,i){i=i||{};var o=e.extend({submitHandler:null},i);s=new n(e(t)),s.init(o)},t}(jQuery,spweb.Form),spweb.offlineDevices=function(e,n){"use strict";var t,s,i,o,a,l,c={},r="removed",u="."+r,d="alert-danger",f="alert-success",p=".device";return c.init=function(){o=e("#offline-devices-container"),a=e("#devices-table-container, #list-offline-devices"),l=e("#all-devices-button"),s=e('<p class="alert"></p>').attr("id","device-message"),t=e('<div class="throbber"><div></div></div>'),i=e('<div class="device-overlay"></div>'),this.removeDevice(),this.removeAllDevices()},c.removeDevice=function(){a.delegate("button","click",c._onClick)},c._onClick=function(n){var t=a.find(p).not(u);s.remove(),t.length>1?(e(this).parents(p).fadeOut(200).addClass(r),c._sendPost.bind(this)()):c._sendPostAll.bind(this)()},c._sendPost=function(){var t=this;e.ajax({type:"POST",url:"/"+n.getMarket()+"/account/remove-offline/",data:{device:e(this).attr("data-device")}}).done(function(e){c._onDone.bind(t)(e)}).fail(function(e,n,s){c._onFail.bind(t)(null,null,s)}).always(function(){c._onAlways.bind(t)()})},c._onDone=function(n){n.status?e(this).parents(p).remove():c._onFail.bind(this)(null,null,n.message)},c._onFail=function(e,n,t){c._showAlert(t)},c._onAlways=function(){t.remove()},c._showAlert=function(e){s.hide(),o.before(s.addClass(d).text(e)),s.fadeIn()},c.removeAllDevices=function(){l.delegate("button","click",c._onClickAll)},c._onClickAll=function(n){s.remove(),e(this).prop("disabled",!0),i.append(t).hide(),o.append(i),i.fadeIn(),c._sendPostAll.bind(this)()},c._sendPostAll=function(){var t=this;e.ajax({type:"POST",url:"/"+n.getMarket()+"/account/remove-offline-devices/",data:{}}).done(function(e){c._onDoneAll.bind(t)(e)}).fail(function(e,n,s){c._onFailAll.bind(t)(null,null,s)}).always(function(){c._onAlways.bind(t)()})},c._onDoneAll=function(e){e.status?c._onRemoveAll(e.message):c._onFailAll(null,null,e.message)},c._onFailAll=function(e,n,t){l.prop("disabled",!1),i.hide(),c._showAlert(t)},c._onRemoveAll=function(e){s.addClass(f).text(e).hide().css("margin-bottom",o.height()),o.before(s).delay(250).fadeOut(500,function(){s.fadeIn()})},c}(jQuery,spweb.user),spweb.recoverPlaylists=function(e){"use strict";var n,t,s,i,o={},a="alert-danger",l="success",c=".playlist";return o.init=function(a){n=a,t=e("#deleted-playlists"),i=e('<p class="alert"></p>').attr("id","playlist-message"),s=t.data("endpoint"),o._addEventHandlers(t)},o._addEventHandlers=function(e){e.on("click","button",o._onClick)},o._onClick=function(){i.remove(),e(this).hide().closest(c).addClass(l).end().parent().append('<b class="restored">'+n+"</b>"),o._sendPost.bind(this)()},o._sendPost=function(){var n=this;e.ajax({type:"POST",data:{playlist:e(this).attr("data-playlist")},url:s}).done(function(e){o._onDone.bind(n)(e)}).fail(function(e,t,s){o._onFail.bind(n)(e,t,s)})},o._onDone=function(n){n.status?e(this).remove():o._onFail.bind(this)(null,null,n.message)},o._onFail=function(n,s,o){e(this).show().closest(c).removeClass(l).end().parent().children(".restored").remove(),t.before(i.text(o).addClass(a))},o}(jQuery);var spweb=spweb||{};spweb.account=spweb.account||{},spweb.account.requirePassword=function(e){var n=e("#profile_confirmPassword"),t=e("#profile_email"),s=t.val(),i={};return i.init=function(){t.on("keyup",i.onKeyUp)},i.onKeyUp=function(t){var i=e(this);s!==i.val()?n.removeAttr("disabled"):n.attr("disabled","disabled")},i}(jQuery);var spweb=spweb||{};spweb.account=spweb.account||{},spweb.account.signout=function(e){"use strict";var n={},t=null,s=null,i=null,o=null,a=null,l=null,c="alert-success",r="alert-danger";return n.init=function(){t=e("#signout-everywhere"),s=e("#btn-signout-everywhere"),i=e("#sp_csrf_disconnect").val(),o=s.parent("form").attr("action"),a=e('<p class="alert"></p>'),l=e('<div class="throbber"><div></div></div>'),n._addEventHandlers(s)},n._addEventHandlers=function(e){e.on("click",n._sendPost)},n._sendPost=function(t){t.preventDefault(),s.hide(),s.parent().append(l),e.ajax({type:"POST",url:o,data:{sp_csrf:i},success:n._onSuccess,error:n._onFailure})},n._onSuccess=function(e){e.status?(n._updateView(e.message,c,r),window.location.href=e.redirect):n._onFailure(null,null,e.message)},n._onFailure=function(e,t,s){n._updateView(s,r,c)},n._updateView=function(e,n,t){l.remove(),a.text(e).removeClass(t).addClass(n),s.parent().prepend(a),a.delay(4e3).fadeOut(1e3,function(){s.show(),a.remove()})},n}(jQuery);var spweb=spweb||{};spweb.account=spweb.account||{},spweb.account.subscription=function(e){"use strict";var n={};return n.init=function(){e(".itunes-cancel-subs-link").on("click",function(){var n=e(".itunes-cancellation-disclaimer").show().offset();e("body").animate({scrollTop:n.top},1e3)})},n}(jQuery);var spweb=spweb||{};spweb.account=spweb.account||{},spweb.account.notifications=function(e){"use strict";var n={};return n.init=function(){var n=e("form.form-notifications");e("#notifications_save").on("click",function(){e(this).attr("disabled",!0),n.submit()})},n}(jQuery);